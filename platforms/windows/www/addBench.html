<!DOCTYPE html>
<html>
    <head>
        <title>Add Bench</title>
        <meta charset=utf-8 />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet"  href="http://code.jquery.com/mobile/git/jquery.mobile-git.css" /> 
        <link href="css/jquery.mobile.datepicker.css" rel="stylesheet" type="text/css"/>
        <link href="css/jquery.mobile.datepicker.theme.css" rel="stylesheet" type="text/css"/>
        <script src="js/jquery.js" type="text/javascript"></script>
        <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
        <script src="http://code.jquery.com/jquery-1.9.1.js"></script>       
        <script src="js/datepicker.js" type="text/javascript"></script>
        <script src="http://code.jquery.com/mobile/git/jquery.mobile-git.js"></script> 
        <script src="jquery.mobile.datepicker.js"></script>
        <script src="js/jquery.mobile.datepicker.js" type="text/javascript"></script>
        <script type="text/javascript">
            var dateInput = null;
            var weightInput = null;
            var repsInput = null;
            var addressInput = null;
            var db = null;
            /** Called when phonegap javascript is loaded */
            function onDeviceReady() {
                var addButton = document.getElementById("add");
                dateInput = document.getElementById("date");
                weightInput = document.getElementById("weight");
                repsInput = document.getElementById("reps");
                addressInput = document.getElementById("address");

                db = window.openDatabase("performanceDB", "1.0", "Performance Database", 1000000);//name,version,display name, size
                alert("device Ready");
            }


            function savePerf() {
                var addButton = document.getElementById("add");
                dateInput = document.getElementById("date");
                weightInput = document.getElementById("weight");
                repsInput = document.getElementById("reps");
                addressInput = document.getElementById("address");

                db = window.openDatabase("performanceDB", "1.0", "Performance Database", 1000000);//name,version,display name, size
                db.transaction(
                        //function sql statements
                                function (tx) {
                                    ensureTableExists(tx);
                                    var date = dateInput.value;
                                    var weight = weightInput.value;
                                    var reps = repsInput.value;
                                    var address = addressInput.value;

                                    var sql = 'INSERT INTO Performances (date, weight,reps,address) VALUES ("' + date + '","' + weight + '","' + reps + '","' + address + '")';
                                    tx.executeSql(sql);
                                },
                                //error callback
                                        function (err) {
                                            alert("error callback " + err.code);

                                        },
                                        //success callback
                                                function (err) {
                                                    window.location.href = "benchList.html";
                                                    alert("Performance added");
                                                }
                                        );
                                    }

                            function ensureTableExists(tx) {
                                tx.executeSql('CREATE TABLE IF NOT EXISTS Performances (id INTEGER PRIMARY KEY, date,weight,reps,movement,photo,address)');

                            }
                            /** Called when browser load this page*/
                            function init() {
                                document.addEventListener("deviceready", onDeviceReady, false);
                            }
        </script>
    </head>
    <body onload="init()">
        <div data-role="page">
            <div data-role="header">
                <h1>Bench Press</h1>
            </div><!-- /header -->
            <div data-role="content">
                <div>
                    <label>Date</label>
                    <input id="date" type="text" class="date-input" data-inline="false" data-role="date" >
                    <label>Weight Kg</label>
                    <input id="weight" type="number">
                    <label>Repetitions</label>
                    <input id="reps" type="number">
                    <label>Photo</label>
                    <button>Import</button>
                    <label>Address</label>
                    <input id="address" type="text" >
                    <button onclick="savePerf();">Save</button>
                </div>
            </div>
        </div>
    </body>
</html>